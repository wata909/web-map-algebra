# ワイン用ブドウ栽培適地評価システム
## 本システムについて
本システムは，データタイルマップとして公開されている地形，地質，土壌，気象データを元に，WebGLによる地図間演算機能を用いてブドウのワイン専用品種の栽培適地を評価するためのプログラムです。  
現在のシステムは，クライアント側で動作するWebGISとしての機能開発を目的として構築，公開されたものであるため，現時点では，有効な適地推定ができないことに留意下さい。  
本システムの概要については，以下にて発表しました。  

- 岩崎亘典，・林 和則，田中聡久，鹿取みゆき，小口 高(2021)WebGLを用いたワイン用ブドウ栽培適地評価システムの開発．地理情報システム学会第30回学術研究発表大会

## 利用方法
本システムに接続すると，以下の画面が表示されます。  
![image](https://user-images.githubusercontent.com/3130494/140027552-624d1a06-5a26-4445-b09c-09403f9d5279.png)
基本的な操作は左上に配置した操作パネルから実行します。本件システムでは予め設定された評価条件から任意の条件を適用して栽培適地評価を実行します。現在利用可能な条件は「地質」「土壌分類」「傾斜量」「傾斜方位」「平均気温」「最低気温」「最高気温」の7つです。  
初期表示状態ではいずれの評価条件も選択されていない状態です。  
![image](https://user-images.githubusercontent.com/3130494/140028094-56611c37-d2d2-4008-b26a-d1980bf9e5e9.png)

評価条件を適用するには，適用したい評価条件のチェックボックスをチェックをいれます。すると，当該条件の背景色が赤になり，「評価式」ボタンの文字色が赤にります（下の図は地質にチェックを入れた場合です）。「評価式」ボタンの赤い文字は，当該条件の評価式を入力していない状態を示します。  
![image](https://user-images.githubusercontent.com/3130494/140028161-8358e905-d3d7-4149-b46e-0a7134f806b4.png)

ここでは，サンプルとして以下の式を入力します。  
```
if ( geol == 16777170 ) 1
if ( geol == 16775900 ) 1
if ( geol == 14483420 ) 1
if ( geol == 14873058 ) 1 
if ( geol == 16775065 ) 1 
if ( geol == 15138815 ) 0.5 
0
```

上記の式は，「地質が汽水成層ないし海成・非海成混合層（16777170）の場合，評価値が１とする」	ということを意味します。この式を入力したあと，右下の「適用」をクリックします。  
![image](https://user-images.githubusercontent.com/3130494/140029047-2eda568d-6b3b-4df5-863c-562c8e70f96a.png)

すると，下の図の通り，当該条件の背景色は赤のままで，「評価式」ボタンの文字色は黒になります．  
![image](https://user-images.githubusercontent.com/3130494/140029165-ccf37e4f-f044-400c-a000-b47b0b79177b.png)

以上の処理を，最低気温，最高気温についても，行います。評価式は，以下の通りです。  

平均最低気温  
```
if ( tMin < 5 ) 0
1
```

平均最高気温  
```
if ( tMax > 15 ) 0
if ( tMax > 10 ) 1
if ( tMax > 5 ) 0.5
0
```

すべての条件を入力すると，地質，最低気温，最高気温の背景が赤になります。  
![image](https://user-images.githubusercontent.com/3130494/140029717-c873a72c-8483-436c-a011-ef7049640eb5.png)

次に，全体評価式を入力します。
```
geol * tMax * tMax
```
![image](https://user-images.githubusercontent.com/3130494/140029876-a96f04a9-cd8f-49c9-b646-8fd1b8d9c4d6.png)

最後に判別式を入力します。
```
value
```
![image](https://user-images.githubusercontent.com/3130494/140030030-67f4ea7e-58cb-4225-bcb7-69d912b93d1f.png)

すべての条件の入力を終えると，以下の通りとなります．  
![image](https://user-images.githubusercontent.com/3130494/140030172-1108684f-2720-4e60-83a6-922a15cc57c7.png)

最後に「反映」ボタンをクリックすると，評価結果が表示されます。この式の場合，生産適地としての好適度は，１～０の数値で示され，ピンク色が濃いほど好適度が高いことを意味します。  
![image](https://user-images.githubusercontent.com/3130494/140030310-c0f4ded2-9af6-4f71-ba32-74e028a89d95.png)

また，「画像として保存」をクリックし，範囲を指定した後に，右上の「取得する」をくりっくすると，評価結果を画像として保存することができます。  
![image](https://user-images.githubusercontent.com/3130494/140030726-161b12be-8b38-4f33-a2b1-34603d21dfe6.png)



## デモサイト
https://wata909.github.io/web-map-algebra/
